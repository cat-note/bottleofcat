#include <iostream>
#include <vector>
#include <stack>

using namespace std;

typedef vector<int> Seq;

typedef struct TreeNode
{
    int data;
    TreeNode *left;
    TreeNode *right;
} *Tree;

void insertNode(Tree &bst, int data);                             // æ’å…¥èŠ‚ç‚¹
bool samePreorder(Tree bst, const Seq &preorder, bool &mirrored); // åˆ¤æ–­æ˜¯å¦æ»¡è¶³å…ˆåºåºåˆ—
void printPostorder(Tree bst, bool mirrored);                     // æ‰“å°ååºåºåˆ—

int main()
{
    Tree bst = NULL; // äºŒå‰æœç´¢æ ‘
    int nodeNum;     // äºŒå‰æœç´¢æ ‘èŠ‚ç‚¹æ•°
    cin >> nodeNum;
    Seq preorder(nodeNum); // å…ˆåºåºåˆ—
    for (int i = 0; i < nodeNum; i++)
    {
        cin >> preorder[i];           // è¯»å…¥å…ˆåºåºåˆ—
        insertNode(bst, preorder[i]); // æ’å…¥æ ‘ä¸­
    }
    bool mirrored = false; // æ˜¯å¦æ˜¯é•œåƒ
    if (samePreorder(bst, preorder, mirrored))
    {
        cout << "YES\n";
        printPostorder(bst, mirrored);
    }
    else
    {
        cout << "NO";
    }
    return 0;
}

// æ’å…¥èŠ‚ç‚¹
void insertNode(Tree &bst, int data)
{
    Tree node = new TreeNode();
    node->left = NULL;
    node->right = NULL;
    node->data = data;
    if (!bst)
    { // ç©ºæ ‘çš„æƒ…å†µ
        bst = node;
        return;
    }
    Tree curr = bst;
    while (curr)
    {
        if (data >= curr->data)
        {
            if (!curr->right)
            {
                curr->right = node;
                break;
            }
            curr = curr->right;
        }
        else
        {
            if (!curr->left)
            {
                curr->left = node;
                break;
            }
            curr = curr->left;
        }
    }
}

// åˆ¤æ–­æ˜¯å¦æ»¡è¶³å…ˆåºåºåˆ—
bool samePreorder(Tree bst, const Seq &preorder, bool &mirrored)
{
    int index = 0;         // ç”¨äºæ¯”å¯¹å…ˆåºåºåˆ—çš„ä¸‹æ ‡
    stack<Tree> traversal; // å€ŸåŠ©æ ˆæ¥å…ˆåºéå†æ ‘
    traversal.push(bst);
    while (!traversal.empty())
    {
        Tree curr = traversal.top();
        traversal.pop();
        if (!curr) // ä¸å¤„ç†ç©ºç»“ç‚¹
            continue;
        // é€ä¸€æ¯”å¯¹å½“å‰éå†çš„å…ˆåºåºåˆ—å’Œé¢˜ç›®ç»™å‡ºçš„å…ˆåºåºåˆ—
        if (preorder[index++] != curr->data)
        {
            // å‡ºç°äº†åºåˆ—ä¸åŒ¹é…ï¼Œå°±ä¸å†ç»§ç»­
            if (!mirrored) // å°è¯•å¯¹æ¯”é•œåƒ
                return samePreorder(bst, preorder, mirrored = true);
            else // é•œåƒäº†è€¶ä¸åŒ¹é…ï¼Œè¯´æ˜å…ˆåºåºåˆ—æœ‰è¯¯
                return false;
        }
        if (!mirrored)
        {
            // å½“å‰ä¸æ˜¯é•œåƒï¼Œæ ¹->å·¦->å³
            traversal.push(curr->right);
            traversal.push(curr->left);
        }
        else
        {
            // å¦‚æœæ˜¯é•œåƒå°±æ ¹->å³->å·¦
            traversal.push(curr->left);
            traversal.push(curr->right);
        }
    }
    return true;
}

// æ‰“å°ååºéå†åºåˆ—
void printPostorder(Tree bst, bool mirrored)
{
    if (!bst)
        return;
    stack<Tree> traversal;
    stack<int> output; // è¾“å‡ºæ ˆ
    traversal.push(bst);
    while (!traversal.empty())
    {
        Tree curr = traversal.top();
        traversal.pop();
        if (!curr)
            continue;
        output.push(curr->data); // å‹å…¥åˆ°è¾“å‡ºæ ˆ
        if (!mirrored)
        {
            // éé•œåƒ: å·¦-å³-æ ¹, è¿™é‡Œå› ä¸ºè¦å‹å…¥è¾“å‡ºæ ˆï¼Œè¿˜è¦åå‘ä¸€æ¬¡ï¼Œæ‰€ä»¥æ˜¯è¿™æ ·å†™
            traversal.push(curr->left);
            traversal.push(curr->right);
        }
        else
        {
            // é•œåƒ: å³-å·¦-æ ¹
            traversal.push(curr->right);
            traversal.push(curr->left);
        }
        delete curr; // é¡ºå¸¦é‡Šæ”¾æ‰å†…å­˜, ä¸å†™çš„è¯èƒ½å¿«1mså·¦å³
    }
    // è¾“å‡ºæ ˆä¸­åºåˆ—
    bool putSpace = false; // æ˜¯å¦åœ¨å‰é¢å¡«å……ç©ºæ ¼ï¼Œé˜²æ­¢å¤šä½™ç©ºæ ¼è¾“å‡º
    while (!output.empty())
    {
        if (putSpace)
            cout << " ";
        else
            putSpace = true;
        cout << output.top();
        output.pop();
    }
}

/*
    è¿™é¢˜çš„æ€è·¯æ¯”è¾ƒç®€å•ï¼Œä¸è¿‡æœ‰ä¸€ä¸ªè¦æ³¨æ„çš„ç‚¹:

        - ğŸ’¡ é¢˜ç›®ä¸­æåˆ°ï¼Œè¿™é‡Œçš„BSTå¯ä»¥æœ‰ã€é‡å¤é”®å€¼ã€‘ã€‚
            â€œè€Œå…¶å³å­æ ‘åŒ…å«å¤§äºæˆ–ã€ç­‰äºã€‘è¯¥ç»“ç‚¹çš„é”®å€¼â€

    ä¸»è¦æ€è·¯å¦‚ä¸‹:

        1. é¦–å…ˆï¼Œç›´æ¥å°†é¢˜ç›®ç»™å‡ºçš„å…ˆåºåºåˆ—ä¾æ¬¡è¾“å…¥å°±å¯ä»¥ã€æ„é€ å‡ºäºŒå‰æœç´¢æ ‘ã€‘ã€‚

        2. åˆ©ç”¨å †æ ˆå¯¹äºŒå‰æœç´¢æ ‘è¿›è¡Œã€å…ˆåºéå†ã€‘:

            a. å…ˆå°†æ ¹èŠ‚ç‚¹å‹å…¥æ ˆ
            b. ä»æ ˆä¸­å¼¹å‡ºèŠ‚ç‚¹ï¼Œæ¯”å¯¹è¯¥èŠ‚ç‚¹ã€åœ¨å…ˆåºåºåˆ—ä¸­çš„ä½ç½®ã€‘æ˜¯å¦ã€å’Œé¢˜ç›®æä¾›çš„å…ˆåºåºåˆ—ä¸­çš„ä¸€è‡´ã€‘ã€‚
            c. å°†å…¶å³ã€å·¦èŠ‚ç‚¹ä¾æ¬¡å‹å…¥æ ˆ

            å…¶ä¸­b,cæ˜¯è¿­ä»£è¿‡ç¨‹ï¼Œç›´åˆ°ã€bä¸­å‘ç°å…ˆåºåºåˆ—ä¸åŒ¹é…ã€‘æˆ–è€…ã€æ ˆç©ºã€‘ä¸ºæ­¢ã€‚

                - å¦‚æœæ˜¯å‘ç°å’Œå…ˆåºåºåˆ—ä¸åŒ¹é…ï¼Œå°±è¿›å…¥ç¬¬ã€3ã€‘æ­¥

                - å¦‚æœæ˜¯æ ˆç©ºï¼Œè¯´æ˜å…ˆåºåºåˆ—åŒ¹é…ï¼Œè¿›å…¥ç¬¬ã€5ã€‘æ­¥

        3. å¦‚æœç¬¬2æ­¥å…ˆåºåºåˆ—ä¸åŒ¹é…ï¼Œå°±å¯¹æœç´¢äºŒå‰æ ‘çš„ã€é•œåƒã€‘è¿›è¡Œã€å…ˆåºéå†ã€‘:

            ä¸åŒçš„åœ°æ–¹å°±æ˜¯ç¬¬ã€cã€‘æ­¥ä¸­æ˜¯å°†å…¶ã€å·¦ã€å³ã€‘èŠ‚ç‚¹ä¾æ¬¡å‹å…¥æ ˆ (å®ç°é•œåƒBST)

            ç„¶åå¦‚æœè¿™ä¸ªæ—¶å€™è¿˜å‡ºç°äº†å…ˆåºåºåˆ—ä¸åŒ¹é…ï¼Œè¯´æ˜ã€é¢˜ç›®ç»™çš„å…ˆåºåºåˆ—æ— æ³•æ„é€ ç¬¦åˆè¦æ±‚çš„BSTã€‘ï¼Œè¿›å…¥ç¬¬ã€4ã€‘æ­¥

        4. è¾“å‡ºNO

        5. è¾“å‡ºYESï¼Œæ¥ç€åˆ©ç”¨å †æ ˆå¯¹æœç´¢äºŒå‰æ ‘è¿›è¡Œã€ååºéå†ã€‘

            ä¸»ä½“ä¸Šå’Œå…ˆåºéå†å¾ˆåƒï¼Œä¸åŒçš„åœ°æ–¹åœ¨äº:

                1. é™¤äº†éå†æ ˆå¤–æ–°å¢äº†ä¸€ä¸ªè¾“å‡ºæ ˆï¼Œä»éå†æ ˆã€å¼¹å‡ºã€‘çš„å…ƒç´ ä¼šè¢«ã€å‹å…¥è¾“å‡ºæ ˆã€‘ï¼Œè€Œä¸æ˜¯è¾“å‡ºã€‚

                2. å¦‚æœæ˜¯ã€éé•œåƒã€‘BSTçš„èŠ‚ç‚¹ï¼Œå°±å°†å…¶ã€å·¦ã€å³ã€‘èŠ‚ç‚¹ä¾æ¬¡å‹å…¥éå†æ ˆ (å› ä¸ºè¾“å‡ºæ ˆè¿˜è¦æŠŠé¡ºåºå€’è¿‡æ¥ä¸€æ¬¡)

                3. å¦‚æœæ˜¯ã€é•œåƒã€‘BSTçš„èŠ‚ç‚¹ï¼Œå°±å°†å…¶ã€å³ã€å·¦ã€‘èŠ‚ç‚¹ä¾æ¬¡å‹å…¥éå†æ ˆ

            æœ€åå¼¹å‡ºã€è¾“å‡ºæ ˆå…ƒç´ ã€‘å¹¶è¾“å‡ºå³å¯ã€‚

    ------------------------------------
        - SomeBottle 2023.1.21
*/
/*
7-28 æœç´¢æ ‘åˆ¤æ–­
    å¯¹äºäºŒå‰æœç´¢æ ‘ï¼Œæˆ‘ä»¬è§„å®šä»»ä¸€ç»“ç‚¹çš„å·¦å­æ ‘ä»…åŒ…å«ä¸¥æ ¼å°äºè¯¥ç»“ç‚¹çš„é”®å€¼ï¼Œè€Œå…¶å³å­æ ‘åŒ…å«å¤§äºæˆ–ç­‰äºè¯¥ç»“ç‚¹çš„é”®å€¼ã€‚å¦‚æœæˆ‘ä»¬äº¤æ¢æ¯ä¸ªèŠ‚ç‚¹çš„å·¦å­æ ‘å’Œå³å­æ ‘ï¼Œå¾—åˆ°çš„æ ‘å«åšé•œåƒäºŒå‰æœç´¢æ ‘ã€‚

    ç°åœ¨æˆ‘ä»¬ç»™å‡ºä¸€ä¸ªæ•´æ•°é”®å€¼åºåˆ—ï¼Œè¯·ç¼–å†™ç¨‹åºåˆ¤æ–­è¯¥åºåˆ—æ˜¯å¦ä¸ºæŸæ£µäºŒå‰æœç´¢æ ‘æˆ–æŸé•œåƒäºŒå‰æœç´¢æ ‘çš„å‰åºéå†åºåˆ—ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¾“å‡ºå¯¹åº”äºŒå‰æ ‘çš„ååºéå†åºåˆ—ã€‚

è¾“å…¥æ ¼å¼:
    è¾“å…¥çš„ç¬¬ä¸€è¡ŒåŒ…å«ä¸€ä¸ªæ­£æ•´æ•°Nï¼ˆâ‰¤1000ï¼‰ï¼Œç¬¬äºŒè¡ŒåŒ…å«Nä¸ªæ•´æ•°ï¼Œä¸ºç»™å‡ºçš„æ•´æ•°é”®å€¼åºåˆ—ï¼Œæ•°å­—é—´ä»¥ç©ºæ ¼åˆ†éš”ã€‚
è¾“å‡ºæ ¼å¼:
    è¾“å‡ºçš„ç¬¬ä¸€è¡Œé¦–å…ˆç»™å‡ºåˆ¤æ–­ç»“æœï¼Œå¦‚æœè¾“å…¥çš„åºåˆ—æ˜¯æŸæ£µäºŒå‰æœç´¢æ ‘æˆ–æŸé•œåƒäºŒå‰æœç´¢æ ‘çš„å‰åºéå†åºåˆ—ï¼Œåˆ™è¾“å‡ºYESï¼Œå¦ä¾§è¾“å‡ºNOã€‚å¦‚æœåˆ¤æ–­ç»“æœæ˜¯YESï¼Œä¸‹ä¸€è¡Œè¾“å‡ºå¯¹åº”äºŒå‰æ ‘çš„ååºéå†åºåˆ—ã€‚æ•°å­—é—´ä»¥ç©ºæ ¼åˆ†éš”ï¼Œä½†è¡Œå°¾ä¸èƒ½æœ‰å¤šä½™çš„ç©ºæ ¼ã€‚
è¾“å…¥æ ·ä¾‹1:
    7
    8 6 5 7 10 8 11
è¾“å‡ºæ ·ä¾‹1:
    YES
    5 7 6 8 11 10 8
è¾“å…¥æ ·ä¾‹2:
    7
    8 6 8 5 10 9 11
è¾“å‡ºæ ·ä¾‹2:
    NO
ä»£ç é•¿åº¦é™åˆ¶
    16 KB
æ—¶é—´é™åˆ¶
    400 ms
å†…å­˜é™åˆ¶
    64 MB
*/