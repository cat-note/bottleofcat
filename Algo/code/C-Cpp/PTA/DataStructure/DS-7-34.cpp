#include <cstdio>
#include <vector>

using namespace std;

/*
    æœ¬é¢˜è€ƒå¯Ÿå¯¹ã€æœ‰å‘å›¾æ˜¯å¦æœ‰ç¯ã€‘çš„åˆ¤æ–­ï¼Œé€‚åˆé‡‡ç”¨æ‹“æ‰‘æ’åº
*/

// é‚»æ¥è¡¨èŠ‚ç‚¹
typedef struct ListNode
{
    int data; // è®°å½•å…¥åº¦æ•°æˆ–é‚»æ¥ç‚¹ä¸‹æ ‡
    ListNode *next;
} *List;

// é‚»æ¥è¡¨
class AdjList
{
private:
    int vertexNum;
    vector<List> listArr;

public:
    AdjList(int vertexNum)
    {
        this->vertexNum = vertexNum;
        // åˆå§‹åŒ–é‚»æ¥è¡¨
        listArr.resize(vertexNum);
        for (int i = 0; i < vertexNum; i++)
        {
            List node = new ListNode();
            node->data = 0; // åˆå§‹å…¥åº¦æ•°ä¸º0
            node->next = NULL;
            listArr[i] = node;
        }
    }
    ~AdjList()
    {
        // ææ„æ—¶é‡Šæ”¾å†…å­˜
        for (int i = 0; i < vertexNum; i++)
        {
            List curr = listArr[i]->next;
            while (curr)
            {
                List next = curr->next;
                delete curr;
                curr = next;
            }
            delete listArr[i];
        }
    }
    // å¾€æœ‰å‘å›¾ä¸­æ·»åŠ ä¸€æ¡v1æŒ‡å‘v2çš„è¾¹
    void addEdge(int v1, int v2)
    {
        List node = new ListNode();
        node->data = v2; // æŒ‡å‘v2
        node->next = listArr[v1]->next;
        listArr[v1]->next = node; // å¤´æ’æ³•
        listArr[v2]->data++;      // v2é¡¶ç‚¹çš„å…¥åº¦å¢åŠ 
    }
    // æ‹“æ‰‘æ’åºåˆ¤æ–­æ˜¯å¦æ— ç¯
    bool noCycle()
    {
        // å¤åˆ¶å„é¡¶ç‚¹çš„å…¥åº¦ï¼Œç”¨äºæ‹“æ‰‘æ’åºï¼ŒğŸ’¡ã€ä¸å½±å“åŸé‚»æ¥è¡¨ã€‘
        // ié¡¶ç‚¹è¢«è®¿é—®åï¼Œindegree[i]ä¼šè¢«æ ‡ä¸º-1ï¼Œä»£è¡¨é¡¶ç‚¹è¢«å–å‡º
        vector<int> indegree(vertexNum);
        for (int i = 0; i < vertexNum; i++)
            indegree[i] = listArr[i]->data; // å¤‡ä»½å…¥åº¦ï¼Œå› ä¸ºåé¢è¦æ‹†è¾¹
        while (true)
        {
            bool noZero = true; // æ˜¯å¦æ²¡æœ‰é›¶å…¥åº¦é¡¶ç‚¹
            for (int i = 0; i < vertexNum; i++)
            {
                // æ‰¾æœªè¢«è®¿é—®çš„é›¶åº¦é¡¶ç‚¹
                if (indegree[i] == 0)
                {
                    noZero = false;   // æœ‰0å…¥åº¦çš„é¡¶ç‚¹
                    indegree[i] = -1; // æ ‡è®°å·²è®¿é—®
                    List curr = listArr[i]->next;
                    while (curr)
                    {
                        // â€œæ‹†æ‰â€å…¥è¾¹ï¼Œæ›´æ–°é‚»æ¥ç‚¹å…¥åº¦
                        indegree[curr->data]--;
                        curr = curr->next;
                    }
                }
            }
            if (noZero) // æ²¡æœ‰0å…¥åº¦é¡¶ç‚¹å°±è¿­ä»£ç»“æŸ
                break;
        }
        // æ£€æŸ¥æ˜¯å¦æœ‰é¡¶ç‚¹æœªè¢«å–å‡º
        for (int i = 0; i < vertexNum; i++)
        {
            if (indegree[i] != -1) // æœ‰é¡¶ç‚¹æœªè¢«å–å‡ºå°±è¯´æ˜æœ‰ç¯
                return false;
        }
        return true;
    }
};

int main()
{
    int vertexNum; // é¡¶ç‚¹æ•°
    scanf("%d", &vertexNum);
    // åˆå§‹åŒ–é‚»æ¥è¡¨
    AdjList graph(vertexNum);
    // è¯»å…¥å„ç‚¹çš„ä¾èµ–
    for (int i = 0; i < vertexNum; i++)
    {
        int depend; // ä¾èµ–æ•°
        scanf("%d", &depend);
        // æŸä¸ªé¡¶ç‚¹çš„ä¾èµ–é¡¶ç‚¹å°±æ˜¯å…¶å‰é©±é¡¶ç‚¹ã€‚
        for (int j = 0; j < depend; j++)
        {
            int vertex;
            scanf("%d", &vertex);
            vertex--; // é¢˜ç›®é¡¶ç‚¹ç¼–å·æ˜¯1~Nï¼Œè¿™é‡Œè½¬æ¢ä¸º0~N-1
            graph.addEdge(vertex, i);
        }
    }
    // æ‹“æ‰‘æ’åºåˆ¤æ–­æ˜¯å¦æœ‰ç¯
    printf(graph.noCycle() ? "1" : "0");
    return 0;
}

/*
    æœ¬é¢˜ç»™å‡ºçš„æ˜¯AOVç½‘ï¼Œè¦ä½¿å¾—ä»»åŠ¡è°ƒåº¦å¯è¡Œï¼Œæ•´å¼ å›¾å¿…é¡»æ˜¯ã€æœ‰å‘æ— ç¯å›¾ã€‘ã€‚

    è¦åˆ¤æ–­æœ‰å‘å›¾æ˜¯å¦æœ‰ç¯ï¼Œå’±ç¬¬ä¸€ä¸ªæƒ³åˆ°çš„ç®—æ³•å°±æ˜¯æ‹“æ‰‘æ’åºäº†ã€‚è¿™é‡Œé‡‡ç”¨çš„æ˜¯ã€å¡æ©æ‹“æ‰‘æ’åºç®—æ³•ã€‘:

        1. ä¸æ–­æ‹†æ‰å…¥åº¦ä¸º0çš„é¡¶ç‚¹åŠå…¶å‡ºè¾¹ï¼Œç›´è‡³å›¾ä¸­æ²¡æœ‰å…¥åº¦ä¸º0çš„é¡¶ç‚¹ä¸ºæ­¢
        2. å¦‚æœæ­¤æ—¶è¿˜æœ‰é¡¶ç‚¹æ²¡æœ‰è¢«è®¿é—®ï¼Œè¯´æ˜å›¾ä¸­æœ‰ç¯

    ç®—æ³•æ€è·¯æ˜¯å¾ˆç®€å•çš„ï¼Œçœ‹ä»£ç å°±èƒ½ç†è§£çš„å¾ˆæ¸…æ™°ã€‚
    -----------------------
    â­ å†æ€è€ƒä¸€ä¸‹èƒ½å‘ç°ï¼Œæ‹“æ‰‘æ’åºè¿˜å¯ä»¥å€ŸåŠ©ã€æ ˆã€‘æ¥è¿›è¡Œè¾…åŠ©ã€‚

    ğŸ’¡ å¯ä»¥å‘ç°ï¼Œæ‹“æ‰‘æ’åºæ¯æ¬¡è¿­ä»£ä¸­ï¼Œæˆ‘éƒ½è¦ã€æ‰«æé‚»æ¥è¡¨çš„é¡¶ç‚¹æ•°ç»„ã€‘æ¥å¯»æ‰¾0å…¥åº¦çš„é¡¶ç‚¹ï¼Œåœ¨é¡¶ç‚¹æ•°å¾ˆå¤šçš„æƒ…å†µä¸‹è¿™æ ·ä¼šæœ‰å¾ˆå¤§çš„é¢å¤–å¼€é”€ã€‚
    å¦‚æœã€ç”¨æ ˆå‚¨å­˜æ‰€æœ‰0åº¦é¡¶ç‚¹ã€‘ï¼Œé‚£ä¹ˆæ¯æ¬¡è¿­ä»£ã€åªéœ€è¦å¼¹æ ˆæ“ä½œå³å¯ã€‘ã€‚

    æ ˆè¾…åŠ©çš„é¢˜è§£æˆ‘ä¹Ÿå†™äº†: DS-7-34-withStack.cpp

        - SomeBottle 2023.1.25

*/

/*
7-34 ä»»åŠ¡è°ƒåº¦çš„åˆç†æ€§
    å‡å®šä¸€ä¸ªå·¥ç¨‹é¡¹ç›®ç”±ä¸€ç»„å­ä»»åŠ¡æ„æˆï¼Œå­ä»»åŠ¡ä¹‹é—´æœ‰çš„å¯ä»¥å¹¶è¡Œæ‰§è¡Œï¼Œæœ‰çš„å¿…é¡»åœ¨å®Œæˆäº†å…¶å®ƒä¸€äº›å­ä»»åŠ¡åæ‰èƒ½æ‰§è¡Œã€‚â€œä»»åŠ¡è°ƒåº¦â€åŒ…æ‹¬ä¸€ç»„å­ä»»åŠ¡ã€ä»¥åŠæ¯ä¸ªå­ä»»åŠ¡å¯ä»¥æ‰§è¡Œæ‰€ä¾èµ–çš„å­ä»»åŠ¡é›†ã€‚

    æ¯”å¦‚å®Œæˆä¸€ä¸ªä¸“ä¸šçš„æ‰€æœ‰è¯¾ç¨‹å­¦ä¹ å’Œæ¯•ä¸šè®¾è®¡å¯ä»¥çœ‹æˆä¸€ä¸ªæœ¬ç§‘ç”Ÿè¦å®Œæˆçš„ä¸€é¡¹å·¥ç¨‹ï¼Œå„é—¨è¯¾ç¨‹å¯ä»¥çœ‹æˆæ˜¯å­ä»»åŠ¡ã€‚æœ‰äº›è¯¾ç¨‹å¯ä»¥åŒæ—¶å¼€è®¾ï¼Œæ¯”å¦‚è‹±è¯­å’ŒCç¨‹åºè®¾è®¡ï¼Œå®ƒä»¬æ²¡æœ‰å¿…é¡»å…ˆä¿®å“ªé—¨çš„çº¦æŸï¼›æœ‰äº›è¯¾ç¨‹åˆ™ä¸å¯ä»¥åŒæ—¶å¼€è®¾ï¼Œå› ä¸ºå®ƒä»¬æœ‰å…ˆåçš„ä¾èµ–å…³ç³»ï¼Œæ¯”å¦‚Cç¨‹åºè®¾è®¡å’Œæ•°æ®ç»“æ„ä¸¤é—¨è¯¾ï¼Œå¿…é¡»å…ˆå­¦ä¹ å‰è€…ã€‚

    ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¯¹ä¸€ç»„å­ä»»åŠ¡ï¼Œå¹¶ä¸æ˜¯ä»»æ„çš„ä»»åŠ¡è°ƒåº¦éƒ½æ˜¯ä¸€ä¸ªå¯è¡Œçš„æ–¹æ¡ˆã€‚æ¯”å¦‚æ–¹æ¡ˆä¸­å­˜åœ¨â€œå­ä»»åŠ¡Aä¾èµ–äºå­ä»»åŠ¡Bï¼Œå­ä»»åŠ¡Bä¾èµ–äºå­ä»»åŠ¡Cï¼Œå­ä»»åŠ¡Cåˆä¾èµ–äºå­ä»»åŠ¡Aâ€ï¼Œé‚£ä¹ˆè¿™ä¸‰ä¸ªä»»åŠ¡å“ªä¸ªéƒ½ä¸èƒ½å…ˆæ‰§è¡Œï¼Œè¿™å°±æ˜¯ä¸€ä¸ªä¸å¯è¡Œçš„æ–¹æ¡ˆã€‚ä½ ç°åœ¨çš„å·¥ä½œæ˜¯å†™ç¨‹åºåˆ¤å®šä»»ä½•ä¸€ä¸ªç»™å®šçš„ä»»åŠ¡è°ƒåº¦æ˜¯å¦å¯è¡Œã€‚

è¾“å…¥æ ¼å¼:
    è¾“å…¥è¯´æ˜ï¼šè¾“å…¥ç¬¬ä¸€è¡Œç»™å‡ºå­ä»»åŠ¡æ•°Nï¼ˆâ‰¤100ï¼‰ï¼Œå­ä»»åŠ¡æŒ‰1~Nç¼–å·ã€‚éšåNè¡Œï¼Œæ¯è¡Œç»™å‡ºä¸€ä¸ªå­ä»»åŠ¡çš„ä¾èµ–é›†åˆï¼šé¦–å…ˆç»™å‡ºä¾èµ–é›†åˆä¸­çš„å­ä»»åŠ¡æ•°Kï¼Œéšåç»™å‡ºKä¸ªå­ä»»åŠ¡ç¼–å·ï¼Œæ•´æ•°ä¹‹é—´éƒ½ç”¨ç©ºæ ¼åˆ†éš”ã€‚
è¾“å‡ºæ ¼å¼:
    å¦‚æœæ–¹æ¡ˆå¯è¡Œï¼Œåˆ™è¾“å‡º1ï¼Œå¦åˆ™è¾“å‡º0ã€‚
è¾“å…¥æ ·ä¾‹1:
    12
    0
    0
    2 1 2
    0
    1 4
    1 5
    2 3 6
    1 3
    2 7 8
    1 7
    1 10
    1 7
è¾“å‡ºæ ·ä¾‹1:
    1
è¾“å…¥æ ·ä¾‹2:
    5
    1 4
    2 1 4
    2 2 5
    1 3
    0
è¾“å‡ºæ ·ä¾‹2:
    0
ä»£ç é•¿åº¦é™åˆ¶
    16 KB
æ—¶é—´é™åˆ¶
    400 ms
å†…å­˜é™åˆ¶
    64 MB
*/