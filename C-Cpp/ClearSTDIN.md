# ç®€è®°æ¸…ç©ºCè¯­è¨€è¾“å…¥æ®‹ç•™å†…å®¹

ä¸ºäº†åœ¨å‘½ä»¤è¡Œç¨‹åºä¸­å®ç°å’Œç”¨æˆ·çš„äº¤äº’ï¼Œæˆ‘ä»¬ç¼–å†™çš„ç¨‹åºçš„è¿è¡Œè¿‡ç¨‹ä¸­å¾€å¾€æ¶‰åŠåˆ°å¯¹æ ‡å‡†è¾“å…¥/è¾“å‡ºæµçš„å¤šæ¬¡è¯»å†™ã€‚

åœ¨Cè¯­è¨€ä¸­æ¥å—ç”¨æˆ·è¾“å…¥è¿™ä¸€å—ï¼Œæœ‰ç€ä¸€ä¸ªè€ç”Ÿå¸¸è°ˆçš„é—®é¢˜ï¼šâ€œæ€ä¹ˆæ ·åŠæ—¶æ¸…ç©ºè¾“å…¥æµä¸­çš„æ•°æ®ï¼Ÿâ€
 
è¿™ä¹Ÿæ˜¯è¿™ç¯‡å°ç¬”è®°çš„ä¸»é¢˜å†…å®¹ã€‚

![idling-2022-06-28](https://raw.githubusercontent.com/cat-note/bottleassets/main/img/idling-2022-06-28.png)  

å…ˆä»ç¼“å†²åŒºè¯´èµ·ã€‚

ç¼“å†²åŒºæ˜¯**å†…å­˜ä¸­**åˆ’åˆ†å‡ºæ¥çš„ä¸€éƒ¨åˆ†ã€‚é€šå¸¸æ¥è¯´ï¼Œç¼“å†²åŒºç±»å‹æœ‰ä¸‰ç§ï¼š

* å…¨ç¼“å†²
* è¡Œç¼“å†²
* æ— ç¼“å†²

## è¡Œç¼“å†²

åœ¨Cè¯­è¨€ä¸­ç¼“å†²åŒºè¿™ä¸ªæ¦‚å¿µçš„å­˜åœ¨æ„Ÿè¿˜æ˜¯æŒºå¼ºçš„ï¼Œæ¯”è¾ƒå¸¸ç”¨åˆ°çš„ç¼“å†²åŒºç±»å‹åˆ™æ˜¯**è¡Œç¼“å†²**äº†ï¼Œå¦‚æ ‡å‡†è¾“å…¥æµ `stdin` å’Œæ ‡å‡†è¾“å‡ºæµ `stdout`ä¸€èˆ¬ï¼ˆç»ˆç«¯ç¯å¢ƒä¸‹ï¼‰å°±æ˜¯åœ¨è¡Œç¼“å†²æ¨¡å¼ä¸‹çš„ã€‚  

è¡Œç¼“å†²ï¼Œé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯é’ˆå¯¹è¯¥ç¼“å†²åŒºçš„**I/Oæ“ä½œ**æ˜¯**åŸºäºè¡Œ**çš„ã€‚  
* åœ¨é‡åˆ°**æ¢è¡Œç¬¦**å‰ï¼Œç¨‹åºçš„**è¾“å…¥**å’Œ**è¾“å‡º**éƒ½ä¼šå…ˆè¢«**æš‚å­˜**åˆ°**æµå¯¹åº”**çš„ç¼“å†²åŒºä¸­  

* è€Œåœ¨é‡åˆ°**æ¢è¡Œç¬¦**åï¼ˆæˆ–è€…**ç¼“å†²åŒºæ»¡äº†**ï¼‰ï¼Œç¨‹åºæ‰ä¼šè¿›è¡ŒçœŸæ­£çš„**I/Oæ“ä½œ**ï¼Œå°†è¯¥ç¼“å†²åŒºä¸­çš„æ•°æ®å†™åˆ°å¯¹åº”çš„**æµ** (stream) ä¸­**ä»¥ä¾›åç»­è¯»å–**ã€‚  

å°±**æ ‡å‡†è¾“å…¥**`stdin`è€Œè¨€ï¼Œç”¨æˆ·çš„è¾“å…¥é¦–å…ˆä¼šè¢«å­˜åˆ°**ç›¸åº”çš„è¾“å…¥ç¼“å†²åŒº**ä¸­ï¼Œæ¯å½“ç”¨æˆ·æŒ‰ä¸‹å›è½¦é”®è¾“å…¥ä¸€ä¸ª**æ¢è¡Œç¬¦**ï¼Œç¨‹åºæ‰ä¼šè¿›è¡ŒI/Oæ“ä½œï¼Œå°†ç¼“å†²åŒºæš‚å­˜çš„æ•°æ®å†™å…¥åˆ°`stdin`ä¸­ï¼Œä»¥ä¾›[**è¾“å…¥å‡½æ•°**](#cè¯­è¨€ä¸­å¸¸ç”¨çš„è¾“å…¥å‡½æ•°)ä½¿ç”¨ã€‚  

![stdinBuffer-2022-07-12](https://raw.githubusercontent.com/cat-note/bottleassets/main/img/stdinBuffer-2022-07-12.gif)  

è€Œå¯¹**æ ‡å‡†è¾“å‡º**`stdout`æ¥è¯´ï¼Œè¾“å‡ºå†…å®¹ä¹Ÿé¦–å…ˆä¼šè¢«æš‚å­˜åˆ°**ç›¸åº”çš„è¾“å‡ºç¼“å†²åŒº**ä¸­ï¼Œæ¯å½“è¾“å‡ºæ•°æ®é‡åˆ°**æ¢è¡Œç¬¦**æ—¶ï¼Œç¨‹åºæ‰ä¼šå°†ç¼“å†²åŒºä¸­çš„æ•°æ®å†™å…¥`stdout`ï¼Œç»§è€Œæ‰“å°åˆ°å±å¹•ä¸Šã€‚  

<a id="nonImmediatelyPrint"></a>

è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨ç¼“å†²æ¨¡å¼ä¸‹ï¼Œè¾“å‡ºçš„å†…å®¹ä¸ä¼šç«‹å³æ‰“å°åˆ°å±å¹•ä¸Šï¼š
```c
#include <stdio.h>
int main()
{
	// è®¾ç½®ç¼“å†²æ¨¡å¼ä¸ºè¡Œç¼“å†²ï¼Œç¼“å†²åŒºå¤§å°ä¸º10å­—èŠ‚
	setvbuf(stdout, NULL, _IOLBF, 10);
	fprintf(stdout, "1234567"); // è¿™é‡Œå…ˆå‘stdoutå¯¹åº”çš„ç¼“å†²åŒºä¸­å†™å…¥äº†7å­—èŠ‚
	getchar(); // è¿™é‡Œç­‰å¾…ç”¨æˆ·è¾“å…¥
	printf("89"); // å†å‘stdoutå¯¹åº”çš„ç¼“å†²åŒºä¸­å†™å…¥äº†2å­—èŠ‚
	getchar(); // æ¥ç€ç­‰å¾…ç”¨æˆ·è¾“å…¥
	printf("Print!"); // å†å‘stdoutå¯¹åº”çš„ç¼“å†²åŒºä¸­å†™å…¥äº†6å­—èŠ‚
	getchar(); // æœ€åå†ç­‰å¾…ä¸€æ¬¡ç”¨æˆ·è¾“å…¥
	return 0;
}
```

è¿è¡Œæ•ˆæœï¼š

![outputBuffer_remake-2022-06-28](https://raw.githubusercontent.com/cat-note/bottleassets/main/img/outputBuffer_remake-2022-06-28.gif)

å¯ä»¥çœ‹åˆ°ï¼Œç›´åˆ°æ‰§è¡Œåˆ°ç¬¬äºŒä¸ª`getchar()`æ—¶ï¼Œå±å¹•ä¸Šæ²¡æœ‰æ–°çš„è¾“å‡ºã€‚  

è€Œåœ¨æ‰§è¡Œäº†`printf("Print!")`ä¹‹åï¼Œè¾“å‡ºç¼“å†²åŒº**è¢«å¡«æ»¡**äº†ï¼Œè¾“å‡ºç¼“å†²åŒºä¸­ç°æœ‰çš„`10`å­—èŠ‚çš„æ•°æ®è¢«å†™å…¥åˆ°`stdout`ä¸­ï¼Œç»§è€Œæ‰åœ¨å±å¹•ä¸Šæ‰“å°å‡º`123456789P`ã€‚

ç¼“å†²åŒºå†…å®¹è¢«è¯»èµ°åï¼Œå‰©ä½™çš„å­—ç¬¦ä¸²`rint!`æ¥ç€è¢«å†™å…¥è¾“å‡ºç¼“å†²åŒºã€‚ç¨‹åºè¿è¡Œç»“æŸåï¼Œ**è¾“å‡ºç¼“å†²åŒº**ä¸­çš„å†…å®¹ä¼šè¢«å…¨éƒ¨æ‰“å°åˆ°å±å¹•ä¸Šï¼Œæ‰€ä»¥ä¼šåœ¨æœ€åçœ‹åˆ°`rint!`ã€‚



## Cè¯­è¨€ä¸­å¸¸ç”¨çš„è¾“å…¥å‡½æ•°

è¾“å…¥å‡½æ•°åšçš„å·¥ä½œä¸»è¦æ˜¯ä»**æ–‡ä»¶æµ**ä¸­è¯»å–æ•°æ®ï¼Œäº¦å¯å°†**è¯»å–åˆ°çš„æ•°æ®**å‚¨å­˜åˆ°å†…å­˜ä¸­ä»¥ä¾›åç»­ç¨‹åºä½¿ç”¨ã€‚

### åŸºäºå­—ç¬¦

```c
// ä»ç»™å®šçš„æ–‡ä»¶æµä¸­è¯»ä¸€ä¸ªå­—ç¬¦ (fgetcä¸­çš„ f çš„æ„æ€å³"function")
int fgetc( FILE *stream ); 

// åŒfgetcï¼Œä½†æ˜¯getcçš„å®ç°*å¯èƒ½*æ˜¯åŸºäºå®çš„
int getc( FILE *stream ); 

// ç›¸å½“äºæ˜¯getc(stdin)ï¼Œä»æ ‡å‡†è¾“å…¥æµè¯»å–ä¸€ä¸ªå­—ç¬¦
int getchar(void);

// è¿”å›è·å–çš„å­—ç¬¦çš„ASCIIç å€¼ï¼Œå¦‚æœåˆ°è¾¾æ–‡ä»¶æœ«å°¾å°±è¿”å›EOFï¼ˆå³è¿”å›-1ï¼‰
```

### åŸºäºè¡Œ

```c
// ä»ç»™å®šçš„æ–‡ä»¶æµä¸­è¯»å–(count-1)ä¸ªå­—ç¬¦æˆ–è€…è¯»å–ç›´åˆ°é‡åˆ°æ¢è¡Œç¬¦æˆ–è€…EOF
// fgetsä¸­çš„fä»£è¡¨â€œfileâ€ï¼Œè€Œsä»£è¡¨â€œstringâ€
char *fgets( char *restrict str, int count, FILE *restrict stream );

// è¿”å›æŒ‡å‘å­—ç¬¦ä¸²çš„æŒ‡é’ˆæˆ–è€…ç©ºæŒ‡é’ˆNULL
```

### æ ¼å¼åŒ–è¾“å…¥

```c
// æŒ‰ç…§formatçš„æ ¼å¼ä»æ ‡å‡†è¾“å…¥æµstdinä¸­è¯»å–æ‰€éœ€çš„æ•°æ®å¹¶å‚¨å­˜åœ¨ç›¸åº”çš„å˜é‡ä¸­
// scanfä¸­çš„fä»£è¡¨â€œformatâ€
int scanf( const char *restrict format, ... );

// æŒ‰ç…§formatçš„æ ¼å¼ä»æ–‡ä»¶æµstreamä¸­è¯»å–æ‰€éœ€çš„æ•°æ®å¹¶å‚¨å­˜åœ¨ç›¸åº”çš„å˜é‡ä¸­
// fscanfä¸­å‰ä¸€ä¸ªfä»£è¡¨â€œfile(stream)â€ï¼Œåä¸€ä¸ªfä»£è¡¨â€œformatâ€
int fscanf( FILE *restrict stream, const char *restrict format, ... );

// æŒ‰ç…§formatçš„æ ¼å¼ä»å­—ç¬¦ä¸²bufferä¸­æˆªå–æ‰€éœ€çš„æ•°æ®å¹¶å‚¨å­˜åœ¨ç›¸åº”çš„å˜é‡ä¸­
// sscanfä¸­çš„ç¬¬ä¸€ä¸ªsä»£è¡¨â€œstringâ€ï¼Œå­—ç¬¦ä¸²
int sscanf( const char *restrict buffer, const char *restrict format, ... );

// è¿”å›ä¸€ä¸ªæ•´å‹æ•°å€¼ï¼Œä»£è¡¨æˆåŠŸæ ¹æ®æ ¼å¼èµ‹å€¼çš„å˜é‡æ•°ï¼ˆargumentsï¼‰
```

## æœ€å¸¸åˆ°çš„è¾“å…¥æµé—®é¢˜

å…ˆæ¥ä¸ªä¸ä¼šå‡ºé—®é¢˜çš„ç¤ºä¾‹ï¼š

```c
#include <stdio.h>
int main()
{
	char test1[200];
	char test2[200];
	char testChar;
	printf("Input a Character: \n");
	testChar = getchar();
	fprintf(stdout, "Input String1: \n");
	scanf("%s", test1);
	fprintf(stdout, "Input String2: \n");
	scanf("%s", test2);
	printf("Got String1: [ %s ]\n", test1);
	printf("Got String2: [ %s ]\n", test2);
	printf("Got Char: [ %c ]\n", testChar);
	return 0;
}
```

è¿è¡Œæ•ˆæœï¼š  

![correctExample-2022-06-28](https://raw.githubusercontent.com/cat-note/bottleassets/main/img/correctExample-2022-06-28.png)  

------
å‡ºé—®é¢˜çš„ç¤ºä¾‹ï¼š

```c
#include <stdio.h>
int main()
{
	char test[200];
	char testChar1, testChar2, testChar3;
	fprintf(stdout, "Input String: \n");
	scanf("%3s", test);
	printf("[1]Input a Character: \n");
	testChar1 = getchar();
	printf("[2]Input a Character: \n");
	testChar2 = fgetc(stdin);
	printf("[3]Input a Character: \n");
	testChar3 = getchar();
	printf("Got String: [ %s ]\n", test);
	printf("Got Char1: [ %c ]\n", testChar1);
	printf("Got Char2: [ %c ]\n", testChar2);
	printf("Got Char3: [ %c ]\n", testChar3);
	return 0;
}
```

è¿è¡Œæ•ˆæœï¼š  

![incorrectExample-2022-06-28](https://raw.githubusercontent.com/cat-note/bottleassets/main/img/incorrectExample-2022-06-28.png)  

å› ä¸ºæˆ‘å°†æ ¼å¼è®¾ç½®ä¸ºäº†`%3s`ï¼Œæ‰€ä»¥`scanf`**æœ€å¤š**æ¥æ”¶åŒ…å«ä¸‰ä¸ªå­—ç¬¦çš„å­—ç¬¦ä¸²ã€‚

åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘æŒ‰è¦æ±‚è¾“å…¥äº†ä¸€æ¡å­—ç¬¦ä¸²`Hello`ï¼Œå¹¶æŒ‰ä¸‹**å›è½¦**è¾“å…¥ä¸€ä¸ªæ¢è¡Œç¬¦ï¼Œç¼“å†²åŒºæ•°æ®`Hello\n`è¢«å†™å…¥åˆ°äº†`stdin`ä¸­ã€‚è€Œ`scanf`åªä»æ ‡å‡†æµ`stdin`ä¸­è¯»èµ°äº†`Hel`è¿™ä¸€éƒ¨åˆ†å­—ç¬¦ä¸²ã€‚  

æ­¤æ—¶ï¼Œæ ‡å‡†æµ`stdin`ä¸­å®é™…ä¸Šè¿˜å‰©3ä¸ªå­—ç¬¦ï¼š

1. `l`
2. `o`
3. `\n` (å›è½¦è¾“å…¥çš„æ¢è¡Œç¬¦)

äºæ˜¯æ¥ä¸‹æ¥ä¸‰æ¬¡**é’ˆå¯¹å­—ç¬¦çš„**è¾“å…¥å‡½æ•°åªä¼šåˆ†åˆ«**ä»`stdin`ä¸­**å–èµ°è¿™ä¸‰ä¸ªå­—ç¬¦ï¼Œè€Œ**ä¸ä¼šç­‰å¾…ç”¨æˆ·è¾“å…¥**ï¼Œè¿™å°±æ²¡æœ‰è¾¾åˆ°æˆ‘æƒ³è¦çš„æ•ˆæœã€‚

åœ¨åŸºæœ¬çš„å‘½ä»¤è¡Œç¨‹åºä¸­å¾ˆå®¹æ˜“é‡åˆ°è¿™ç±»é—®é¢˜ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆéœ€è¦åŠæ—¶**æ¸…ç©ºè¾“å…¥æµ`stdin`ä¸­çš„æ•°æ®**ã€‚  

## å¤„ç†æ®‹ä½™å†…å®¹

ğŸ’¡ ä»¥ä¸‹å†…å®¹å‡è®¾`stdout`å’Œ`stdin`ä¸¤ä¸ªæ ‡å‡†æµéƒ½æ˜¯åœ¨**è¡Œç¼“å†²**æ¨¡å¼ä¸‹çš„ã€‚

### æ ‡å‡†è¾“å‡ºæµstdout  

è™½ç„¶æœ¬æ–‡ä¸»è¦æ˜¯å†™è¾“å…¥æµï¼Œä½†è¿™é‡Œæˆ‘è¿˜æ˜¯æ è¿‡ä¸€ä¸‹æ ‡å‡†è¾“å‡ºæµ`stdout`ã€‚Cè¯­è¨€æ ‡å‡†åº“ä¸­æä¾›äº†ä¸€ä¸ª**ç”¨äºåˆ·æ–°è¾“å‡ºæµç¼“å†²åŒº**çš„å‡½æ•°ï¼š

```c
int fflush( FILE *stream );
// å¦‚æœæˆåŠŸäº†ï¼Œè¿”å›0ï¼Œå¦åˆ™è¿”å›EOF(-1)
```

è¦æ¸…ç©ºæ ‡å‡†è¾“å‡ºæµå¯¹åº”çš„ç¼“å†²åŒºï¼Œåªéœ€è¦ä½¿ç”¨`fflush(stdout)`å³å¯ã€‚ä¸Šé¢çš„[è¿™ä¸ªä¾‹å­](#nonImmediatelyPrint)å¯ä»¥ä¿®æ”¹æˆè¿™æ ·ï¼š

```c
#include <stdio.h>
int main()
{
	// è®¾ç½®ç¼“å†²æ¨¡å¼ä¸ºè¡Œç¼“å†²ï¼Œç¼“å†²åŒºå¤§å°ä¸º10å­—èŠ‚
	setvbuf(stdout, NULL, _IOLBF, 10);
	fprintf(stdout, "1234567"); // è¿™é‡Œå…ˆå‘stdoutå¯¹åº”çš„ç¼“å†²åŒºä¸­å†™å…¥äº†7å­—èŠ‚
	fflush(stdout); // åˆ·æ–°ç¼“å†²åŒºï¼Œå°†ç¼“å†²åŒºä¸­çš„æ•°æ®å†™å…¥åˆ°æ ‡å‡†è¾“å‡ºæµä¸­
	getchar(); // è¿™é‡Œç­‰å¾…ç”¨æˆ·è¾“å…¥
	printf("89"); // å†å‘stdoutå¯¹åº”çš„ç¼“å†²åŒºä¸­å†™å…¥äº†2å­—èŠ‚
	fflush(stdout); 
	getchar(); // æ¥ç€ç­‰å¾…ç”¨æˆ·è¾“å…¥
	printf("Print!"); // å†å‘stdoutå¯¹åº”çš„ç¼“å†²åŒºä¸­å†™å…¥äº†6å­—èŠ‚
	getchar(); // æœ€åå†ç­‰å¾…ä¸€æ¬¡ç”¨æˆ·è¾“å…¥
	return 0;
}
```

è¿è¡Œæ•ˆæœï¼š

![outputBuffer_fflush-2022-06-29](https://raw.githubusercontent.com/cat-note/bottleassets/main/img/outputBuffer_fflush-2022-06-29.gif)  

å¯ä»¥çœ‹åˆ°ï¼ŒåŠ å…¥`fflush(stdout)`åï¼Œ**è¾“å‡ºç¼“å†²åŒº**çš„å†…å®¹ä¼šè¢«**åŠæ—¶**å†™å…¥`stdout`ä¸­ï¼Œç»§è€Œæ‰“å°åˆ°å±å¹•ä¸Šã€‚

------
å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ`fflush(stdin)`çš„è¡Œä¸ºæ˜¯**æœªå®šä¹‰**ï¼ˆä¸ç¡®å®šï¼‰çš„ï¼š

> For input streams (and for update streams on which the last operation was input), the behavior is undefined.  

ä¸åŒå¹³å°çš„ç¼–è¯‘å™¨å¯¹æ­¤æœ‰ä¸åŒçš„è§£é‡Šã€‚  

* æ¯”å¦‚åœ¨Windowså¹³å°ä¸Šï¼Œæ— è®ºæ˜¯`VC6.0`è¿™ç§ç›®å‰ä¸€äº›å­¦æ ¡æ•™å­¦è¿˜åœ¨ä½¿ç”¨çš„å¤è‘£ç¼–è¯‘å™¨ï¼Œè¿˜æ˜¯`gcc 8.x.x`ï¼Œå¤§ä½“è¿˜æ˜¯æ”¯æŒé€šè¿‡è¿™ç§æ“ä½œæ¸…ç©ºè¾“å…¥æµçš„ã€‚

* ä½†æ˜¯åœ¨Linuxå¹³å°ä¸Šçš„`gcc`ç¼–è¯‘å™¨å°±ä¸ä¹°è´¦äº†ï¼Œæ˜¯ä¸æ”¯æŒ`fflush(stdin)`è¿™ç§æ“ä½œçš„ã€‚  

å› æ­¤ï¼Œå°½é‡é¿å…`fflush(stdin)`è¿™ç§å†™æ³•ï¼Œè¿™**ååˆ†ä¸åˆ©äºä»£ç çš„å¯ç§»æ¤æ€§**ã€‚

### æ ‡å‡†è¾“å…¥æµstdin

ä¸Šé¢æåˆ°å› ä¸ºå¯ç§»æ¤æ€§è¦é¿å…`fflush(stdin)`è¿™ç§å†™æ³•ï¼Œæ¥ä¸‹æ¥è®°å½•ä¸€ä¸‹å¯ç§»æ¤æ€§é«˜çš„å†™æ³•ã€‚

#### æ¥å—æ ¼å¼åŒ–è¾“å…¥æ—¶å»é™¤å¤šä½™ç©ºç™½ç¬¦

è¿™ä¸€ç§å…¶å®ç”¨çš„æ¯”è¾ƒå°‘ï¼Œä½†æˆ‘è§‰å¾—è¿˜æ˜¯å¾—è®°ä¸€ä¸‹ã€‚

> whitespace characters: any single whitespace character in the format string consumes all available consecutive whitespace characters from the input. Note that there is no difference between "\n", " ", "\t\t", or other whitespace in the format string.  

ä¸Šé¢è¿™æ®µè§£é‡Šæ¥è‡ªäº[cppreference](https://en.cppreference.com/w/c/io/fscanf)ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸­çš„**ç©ºç™½ç¬¦**ï¼ˆå¦‚`"\n"`, `" "`, `"\t\t"`ï¼‰ä¼šå¸æ”¶**è¾“å…¥å­—ç¬¦ä¸²**ä¸­çš„**ä¸€æ®µè¿ç»­çš„ç©ºç™½ç¬¦**ã€‚

ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸‹é¢è¿™å¥æ ¼å¼åŒ–è¾“å…¥å‡½æ•°ï¼š

```c
scanf(" %c %c",&recvChar1,&recvChar2);
```

å¯ä»¥ä»`stdin`ä¸­è¯»å–å½¢å¦‚`  \n  a      b`ï¼Œ` \t a b`è¿™æ ·çš„æ•°æ®ã€‚å…¶ä¸­`a`ä¹‹å‰çš„ç©ºç™½ç¬¦å’Œ`a`ä¸`b`ä¹‹é—´çš„ç©ºç™½ç¬¦éƒ½ä¼šè¢«å¸æ”¶ï¼Œ`scanf`å¾—ä»¥èƒ½å‡†ç¡®è·å–å­—ç¬¦`a`å’Œ`b`ã€‚

ä¾é è¿™ä¸ªç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ¥æ”¶è¾“å…¥æ—¶è‡ªåŠ¨å‰”é™¤`stdin`**ä¸­æ®‹ç•™çš„ç©ºç™½ç¬¦**ï¼š

```c
// å› ä¸ºæ ¼å¼%sä¸ä¼šåŒ¹é…å¤šä½™çš„ç©ºç™½ç¬¦ï¼Œè¿™é‡ŒæŒ‰å›è½¦åï¼Œstdinä¸­ä¼šæ®‹ç•™ä¸€ä¸ªæ¢è¡Œç¬¦\n
scanf("%s",recvStr);
// åœ¨æ ¼å¼%cå‰åŠ ä¸€ä¸ªç©ºæ ¼ï¼Œå¯ä»¥å¸æ”¶æ‰ä¸Šé¢æ®‹ç•™çš„æ¢è¡Œç¬¦\nï¼Œç¨‹åºä¾¿èƒ½å¦‚é¢„æœŸæ¥å—ç”¨æˆ·è¾“å…¥
scanf(" %c",&recvChar);
```

ç„¶è€Œï¼Œè¿™ä¸€ç§æ–¹æ³•ä»…åªèƒ½å‰”é™¤**å¤šä½™çš„ç©ºç™½ç¬¦**ã€‚

#### ä½¿ç”¨ä¸­æ‹¬å·å­—ç¬¦é›†

è¿™ä¸ªè§£å†³æ–¹æ³•å¯ä»¥å’Œä¸Šé¢å‰”é™¤ç©ºç™½ç¬¦çš„æ–¹æ³•è¿›è¡Œç»“åˆã€‚

æ ¼å¼åŒ–è¾“å…¥æœ‰ä¸€ä¸ªè¯´æ˜ç¬¦ `%[set]`ï¼Œå®ƒçš„åŠŸèƒ½å’Œ**æ­£åˆ™è¡¨è¾¾å¼**ä¸­çš„ä¸­æ‹¬å·`[ ]`ååˆ†ç±»ä¼¼ï¼š

* å…¶ä¸­`set`ä»£è¡¨ä¸€ä¸ª**ç”¨äºåŒ¹é…çš„å­—ç¬¦é›†**ï¼Œä¸€èˆ¬æƒ…å†µä¸‹åŒ¹é…çš„æ˜¯å­˜åœ¨å­—ç¬¦é›†ä¸­çš„å­—ç¬¦

* å­—ç¬¦é›†çš„ç¬¬ä¸€ä¸ªå­—ç¬¦å¦‚æœæ˜¯`^`ï¼Œåˆ™è¡¨ç¤º**å–å**ï¼ŒåŒ¹é…çš„æ˜¯**ä¸å­˜åœ¨äºè¯¥å­—ç¬¦é›†ä¸­çš„å­—ç¬¦**

* å¯ä»¥åœ¨ä¸­æ‹¬å·ä¸­ä½¿ç”¨çŸ­æ¨ªçº¿ `-` æ¥è¡¨è¾¾**ä¸€ä¸ªèŒƒå›´**ï¼Œæ¯”å¦‚`%[0-9]`ä»£è¡¨åŒ¹é…0-9ä¹‹é—´çš„å­—ç¬¦ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¯¹äºçŸ­æ¨ªçº¿`-`ï¼Œå¯èƒ½åœ¨**ä¸åŒç¼–è¯‘å™¨**ä¹‹é—´**æœ‰ä¸åŒå®ç°**ï¼Œå®ƒæ˜¯[implementation-defined](#å…³äºimplementation-defined)çš„ã€‚

å¦è¿˜æœ‰ä¸€ä¸ªè¯´æ˜ç¬¦ `*` ï¼Œå®ƒè¢«ç§°ä¸º**èµ‹å€¼æŠ‘åˆ¶**æˆ–**èµ‹å€¼å±è”½**ç¬¦ã€‚å¦‚å­—é¢æ„æ€ï¼Œåœ¨`%`å¼•å¯¼çš„æ ¼å¼è½¬æ¢å­—ä¸²ä¸­å¦‚æœåŒ…å«`*`ï¼Œè¿™ä¸ªæ ¼å¼**åŒ¹é…**çš„å†…å®¹**ä¸ä¼šè¢«èµ‹ç»™ä»»ä½•å˜é‡**ã€‚  

-----

äºæ˜¯ï¼Œå¯ä»¥ç»™å‡ºå¦‚ä¸‹çš„è¯­å¥ï¼š

```c
// æ˜Ÿå· * ä»£è¡¨ä¸ä¼šæŠŠåŒ¹é…åˆ°çš„å†…å®¹èµ‹ç»™å˜é‡ï¼Œç›¸å½“äºâ€œå¸æ”¶â€æ‰äº†
// [^\n] ä»£è¡¨é™¤äº†æ¢è¡Œç¬¦å¤–ä¸€å¾‹åŒ¹é…
scanf("%*[^\n]");
```

å› ä¸ºç”¨æˆ·ç»“æŸä¸€æ¬¡è¾“å…¥çš„æ ‡å¿—é€šå¸¸æ˜¯æŒ‰å›è½¦è¾“å…¥ä¸€ä¸ªæ¢è¡Œç¬¦ï¼Œæ®‹ç•™çš„å†…å®¹å¾€å¾€**æœ«å°¾æ˜¯ä¸€ä¸ªæ¢è¡Œç¬¦**ã€‚ä¸Šé¢è¿™å¥çš„åŸç†å°±æ˜¯**å¸æ”¶æ‰`stdin`ä¸­æ‰€æœ‰çš„æ®‹ä½™å­—ç¬¦**ï¼Œç›´è‡³è¾¾åˆ°æœ€åä¸€ä¸ªå­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯**æ¢è¡Œç¬¦**ã€‚  

ç„¶è€Œï¼Œæ¢è¡Œç¬¦ä¸ä¼šè¢«ä¸Šé¢è¿™å¥æ‰€å¸æ”¶ï¼Œæ‰€ä»¥åœ¨æ¥ä¸‹æ¥çš„è¾“å…¥ä¸­åªéœ€è¦**å¿½ç•¥`stdin`ä¸­çš„æ®‹ä½™ç©ºç™½ç¬¦**å³å¯ï¼ˆæ¢è¡Œç¬¦å°±æ˜¯ç©ºç™½ç¬¦ä¹‹ä¸€ï¼‰ï¼š

```c
scanf("%*[^\n]");
scanf(" %c",&recvChar);
```

è¿™ç§æ–¹æ³•å·²ç»å¯ä»¥è§£å†³ä¸€èˆ¬æƒ…å†µä¸‹çš„è¾“å…¥æ®‹ä½™é—®é¢˜ï¼Œä¸è¿‡åœ¨åç»­æ¥å—æ ¼å¼åŒ–è¾“å…¥æ—¶è¿˜å¾—**å¿½ç•¥æ¢è¡Œç¬¦**`\n`ï¼Œè¿˜æ˜¯æœ‰ç‚¹éº»çƒ¦ã€‚

#### å¾ªç¯å–èµ°æ®‹ä½™å­—ç¬¦  

è¿™ä¸€ç§æ–¹æ³•èƒ½åœ¨æ¸…é™¤æ®‹ä½™æ—¶**é¡ºä¾¿å¸æ”¶æ‰æœ«å°¾çš„æ¢è¡Œç¬¦**`\n`ã€‚  

å–å­—ç¬¦éœ€è¦ç”¨åˆ°[å–å•ä¸ªå­—ç¬¦çš„è¾“å…¥å‡½æ•°](#åŸºäºå­—ç¬¦)ï¼Œè¿™é‡Œä¸ºäº†æ–¹ä¾¿ï¼Œé€‰ç”¨çš„æ˜¯`getchar()`ã€‚  

ä¸€èˆ¬æƒ…å†µä¸‹è¿™æ ·å†™ï¼š

```c
// getchar() ä¼šä» stdin ä¸­å–èµ°ä¸€ä¸ªå­—ç¬¦
while(getchar() != '\n');
```

ï¼ˆä½¿ç”¨å‰æï¼š`stdin`ä¸­æœ‰æ®‹ä½™ï¼‰  

`while`å¾ªç¯ä¼šä¸€ç›´è¿›è¡Œï¼Œç›´è‡³`getchar()`**å–åˆ°**çš„å­—ç¬¦ä¸ºæ¢è¡Œç¬¦`\n`ä¸ºæ­¢ï¼Œè¿™æ ·å°±å¯ä»¥é¡ºå¸¦å¸æ”¶æ‰æœ«å°¾çš„æ¢è¡Œç¬¦äº†ï¼Œèƒ½ç›¸å¯¹å®Œç¾åœ°æ¸…é™¤æ‰`stdin`ä¸­çš„æ®‹ä½™å†…å®¹ã€‚   
ï¼ˆåœ¨**è¡Œç¼“å†²**æ¨¡å¼ä¸‹ï¼Œç”¨æˆ·çš„ä¸€æ¬¡è¾“å…¥é€šå¸¸ä»¥ä¸€ä¸ªæ¢è¡Œç¬¦ç»“æŸï¼‰  

------




1.ç©ºæ ¼format(æ¸…é™¤ä¹‹å‰å¤šä½™çš„ç©ºæ ¼)  
2.%*[^\n]  
3.getchar

ï¼ˆä»€ä¹ˆæ—¶å€™èƒ½getcharå¾—åˆ°EOFï¼‰
ï¼ˆå»ºè®®å°è£…æˆå‡½æ•°ï¼Œæˆ–è€…å®šä¹‰å®(ä¸å»ºè®®)ï¼‰
ï¼ˆå‡½æ•°æ”¾åœ¨å“ªï¼Ÿ->åœ¨æ¯æ¬¡è¾“å…¥åæ‰§è¡Œä¸€æ¬¡è¿™ä¸ªå‡½æ•°ï¼‰


## æ€»ç»“

ä¹‹å‰æµè§ˆäº†å¾ˆå¤šç›¸å…³æ–‡ç« ï¼Œæ ‡é¢˜å’Œå†…å®¹å¤§å¤šéƒ½å†™ç€â€œæ¸…ç©ºè¾“å…¥ç¼“å†²åŒºâ€ã€‚ç°åœ¨æƒ³ä¸€ä¸‹ï¼Œè¿™æ ·å†™å¯èƒ½æ˜¯ä¸å¯¹çš„ï¼Œå› ä¸ºå®é™…æˆ‘æ¸…ç©ºçš„æ˜¯**æ ‡å‡†è¾“å…¥æµ**`stdin`ä¸­çš„æ®‹ç•™å†…å®¹ã€‚åœ¨**ç”¨æˆ·è¾“å…¥å®Œæˆ**ï¼ˆè¾“å…¥æ¢è¡Œç¬¦ï¼‰çš„é‚£ä¸€åˆ»ï¼Œè¾“å…¥ç¼“å†²åŒºå®é™…ä¸Šå°±**å·²ç»è¢«æ¸…ç©º**äº†ã€‚

ä¹Ÿå°±æ˜¯è¯´ï¼Œ**æ ‡å‡†æµ**å’Œå¯¹åº”çš„**ç¼“å†²åŒº**è¦è¾¨åˆ«æ¸…æ¥šï¼ŒäºŒè€…ä¸æ˜¯åŒä¸€ä¸ªæ¦‚å¿µï¼ˆä¸€ä¸ª`stream`ä¸€ä¸ª`buffer`ï¼‰ï¼Œåƒä¸‡ä¸èƒ½æ··æ·†äº†ã€‚

æœ€åï¼Œæ„Ÿè°¢ä½ çœ‹åˆ°è¿™é‡Œ~  
æœ¬ç¬”è®°å¯èƒ½è¿˜æ˜¯æœ‰é”™è¯¯å‡ºç°ï¼Œä¹Ÿè¯·å„ä½å¤šæŒ‡æ•™ï¼

## å‚è€ƒæ–‡çŒ®

### æœ¬ç¬”è®°ç›¸å…³ï¼š  

* [File input/output - cppreference.com](https://en.cppreference.com/w/c/io)  

* [Clarify the difference between input/output stream and input/output buffer - StackOverflow](https://stackoverflow.com/questions/51458342/clarify-the-difference-between-input-output-stream-and-input-output-buffer)

* [End of File in stdin - StackOverflow](https://stackoverflow.com/questions/28216437/end-of-file-in-stdin)  

### å…³äº"implementation-defined"  

* [Undefined, unspecified and implementation-defined behavior - StackOverflow](https://stackoverflow.com/questions/2397984/undefined-unspecified-and-implementation-defined-behavior)  